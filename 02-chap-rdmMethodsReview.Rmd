# A brief overview of ecological regime detection methods methods {#rdmReview-chapter}    
```{r cache = TRUE, echo=FALSE, warning=FALSE, eval=TRUE, message=F}
# Chunk defaults
knitr::opts_chunk$set(cache = TRUE, message = FALSE, warning=FALSE, eval=TRUE, echo=FALSE, 
                      error=FALSE,
                      # fig.width=7, fig.height=7,
                      fig.align='center',
                      out.width = "85%")
```
## Introduction

Long-lasting changes in the underlying structure or functioning of natural systems due to exogeneous forcings (also called regime shifts) is of interest to ecologists. The ability to identify and predict these shifts is particularly useful for systems which are actively managed, provide ecosystem services, or provide benefit to societiy. There exists a disparity among the number of methods proposed for detecting abrupt changes in ecological, oceanographic, and climatological systems and the studies evaluating these methods using empircal data. Despite the already large number of existing methods and models, new methods continue to permeate the literature. Although reviews of regime shift detection methods exist [@scheffer2015generic, @rodionov_brief_2005, @andersen_ecological_2009,  @roberts2018early, @dakos2015resilience, @nichols_detection_2011], the most comprehensive presentation of available methods is outdated [@rodionov_brief_2005]. See also @kefi2014early and @yin2017methods for review and list, respectively of RDMs intended for spatially-explicit data.

There is currently not a single, current resource to which the practical ecologist can refer when identifying or researching  potential RDMs. Previous reviews of this literature vary in both the number and detail of the methods presented. This chapter is meant to serve as an addendum, of sorts, to previous reviews. I follow the style of @rodionov_brief_2005 in that I present a brief overview of RDMs and point the reader to original sources for detailed descriptions of the methods. 

## Methods 

Methods proposed as RSDMs are not easily identified using systematic literature review techniques for a few reasons. First, the terminology associated with regime shift detection methodologies is highly variable within and among fields. For example, the terms, *regime shifts, regime changes and tipping points* are variably used in studies of ecological systems, whereas *inhomogeneities* is common in meterology and climatology and *structural change* is largely confined to econometrics. Although the definition of, e.g., a regime shift and a structural change vary across and within fields of study, some methods are shared.

Second, papers introducing a new method or approach to identifying regime shifts are not often proposed in publications that focus primarily on quantitative methodologies (e.g., *Ecological Modelling*, *Methods in Ecology and Evolution*) or in general ecology journals (e.g., *Ecology*). Instead, they are often published in journals with audiences that may not necessarily overlap with typical searches of the ecological litearture (e.g., *Entropy*, *Progress in Oceanography*). 

I conducted a systematic literature review to identify original papers introducing quantiative regime detection metrics (RDMs). Although the literature review boolean (see below) was designed to detect as many methodological papers as possible, many methods were not found using this method. Therefore, I filled the gaps using prior knowledge. Finally, I gathered additional methods using the snowball method from previous reiews of RDMs [@scheffer2015generic, @rodionov_brief_2005, @andersen_ecological_2009, @roberts2018early, @dakos2015resilience]. 

### Identifying candidate articles

#### Web of Science
I used the Thomson-ISI Web of Science (WoS) database to identify papers published prior to March 2019 which introduced new RDMs. The complete boolean was: 

> TS=(('regime shift' OR 'regime shifts' OR 'regime change' OR 'regime changes' OR 'catastrophic change' OR 'catastrophic shift' OR 'catastrophic changes' OR 'catastrophic shifts' OR 'sudden change' OR 'sudden changes' OR 'abrupt shift' OR 'abrupt shifts OR 'abrupt change' OR 'abrupt changes' OR bistab* OR threshol* OR hystere* OR 'phase shift' OR 'phase shifts' OR 'phase change' OR 'phase changes' OR 'step change' OR 'step changes' OR 'stepped change' OR 'stepped changes' OR 'tipping point' OR 'tipping points' OR 'stable states' OR 'stable state' OR 'state change' OR 'state changes' OR 'stark shift' OR 'stark change' OR 'stark shifts' OR 'stark changes' 'structural change' OR 'structural changes' OR 'change-point' OR 'change point' OR 'change-points' OR 'change point' OR 'break point' OR 'break points' OR 'observational inhomogeneity' OR 'observational inhomogeneities') AND ('new method' OR 'new approach' OR 'novel method' OR 'novel approach')) AND WC=(Ecology OR 'Biodiversity Conservation')

where '*' indicates a wildcard. Next, I read the titles abstracts to retain only articles positing a 'new' RDM. If it was not clear whether a new method was being introduced, I further read the article to determine whether it should be included. 

#### Prior knowledge and snowball method

Next, I gathered methodological papers not identified using the WoS review criteria based both on prior knowledge previous RDM review articles [@scheffer2015generic, @rodionov_brief_2005, @andersen_ecological_2009, @roberts2018early, @dakos2015resilience].

#### Google Scholar
There was a high disparity among the number of methods of which I was previously aware and those identified in an initial Web of Science review. In an attempt to collect as many new methods as possible, I conducted an informal search of the Google Scholar database, which is notoriously broader in scope. The length of boolean for the Google Scholar database is limited by the number of characters. Unfortunately, this, coupled with the wide breadth of Google Scholar's search boundaries, limits the capacity to which Google Scholar can be used to refine the literature to a manageable number of articles. For these reasons I arbitrarily skimmed the titles of the first 25 pages of the Google Scholar results (25 pages = 250 articles). It should be noted that the order of terms appearing in the boolean are regarded as the order of desired relevancy. I used the following boolean:

> ('regime shift' OR 'regime change' OR 'tipping point') AND ('new method' OR 'new approach' OR 'novel method' OR 'novel approach')

### Filtering criteria

In addition to using the abovementioned search booleans, I also excluded the following types of articles: those which proposed a combination of previously-used methods (e.g., PCA combined with other techniques, see @kong2017hydrological, @seddon2014quantitative, @vasilakopoulos2017resilience) as a 'novel' method; those making relatively minor methodological updates/additions to existing methods [@zhou2008one; but see @nicholls2011biological for an addition of variable optimization to the method in @nichols_detection_2011 that was not included in the results]; and articles proposing new methodologies in mathematical journals [@byrski2016double, @salehpour2011line] that have yet to be associated with or tested using ecological or relevant data.

```{r bibAnalysis, echo=F}
# This chunk is the initial analysis of the bibliography results, and turned the search results into csvs for simple reviewing. 
## This script also saves some objects to refer to later in figures in this chapter. 
source(paste0(here::here(), "/chapterFiles/rdmReview/bibliographyAnalysis.R"))

# These values shoudl be  used to manually fill the grViz diagram!
n.wos.start <- bib.wos %>% nrow()
n.gs.start <- 250
# The following objects were saved usign the above mentioned script. 
# n.wos.keep # 3
# n.gs.keep # 3
# n.prior.keep # 11
# total.keep.papers # 60
# total.keep.methods  # 47
```

## Results

A boolean not including the restriction to Ecology and Conservation Biology yielded over 20,000 results. To make the results manageable I restricted the search to the aforementioned fields. This search yielded 2,776 articles. 


```{r rdmReviewFlow, fig.cap="Flowchart of the litearture review process for identifying new regime detection methods. *Only the first ten pages (250 articles) of Google Scholar results were examined. **Other papers include prior knowledge and methods found in previous reviews that were not identified using Google Scholar or Web of Science."}

webshot::install_phantomjs()
DiagrammeR::grViz(
  "digraph {
  graph [layout = dot, rankdir = TB]

  # define the global styles of the nodes. We can override these in box if we wish
  node [shape = rectangle, style = filled, fillcolor = White]
  data0 [label = 'Web of Science \n initial search \n (n = 2776)', shape = folder, fillcolor = Linen]
  data1 [label = 'Web of Science \n filtered by title \n (n = XXX)', shape = folder, fillcolor = Linen]
  data2 [label = 'Google Scholar*\n (n = 250)', shape = folder, fillcolor = Linen]
  data3 [label = 'Other** \n (n = 55)', shape = folder, fillcolor = Linen]

  filter [label = 'Filter', shape = plaintext]

  filter1 [label =  'Web of Science \n (n = 3)']
  filter2 [label =  'Google Scholar\n (n = 3)']
  results [label= 'Final \n (n = 47 methods)']

  # edge definitions with the node IDs
  {data1, data2} -> filter -> {filter1, filter2}
{filter1, filter2, data3} -> results  
}"
  )
```

The Web of Science search yielded `r n.wos.start` unique articles, of which `r n.wos.keep` were retained after filtering (Fig. \@ref(fig:rdmReviewFlow)). Of the `r n.gs.start` articles scanned in Google Scholar, `r n.gs.keep` were retained. Using my prior knowledge of the relevant litearture and referring to methods presented in prior reviews [e.g., @rodionov_brief_2005], I added an additional `r total.keep.methods - n.gs.keep - n.wos.keep` methods. Using these processes, I identified `r total.keep.methods` unique RDMs proposed and/or applied to ecological data (Figs. \@ref(fig:rdmReviewFlow), \@ref(fig:jrnlDistFig), \@ref(fig:jrnlYearFig)). 

```{r jrnlDistFig, fig.cap="Distribution of identified methods across publications. Note: books, reports, and articles without original reference coded as 'Other'"}
# Visualize results
jrnlTemp <- finalMetricsList %>% 
  mutate(journal = ifelse(label =="rodionov_sequential_2005", "Other", journal), 
         journal = ifelse(label =="tong1990nonlinear", "Other", journal), 
         journal = ifelse(journal =="International Journal of Climatology: A Journal of the Royal Meteorological Society", "International Journal of Climatology", journal), 
         journal = ifelse(journal %in% c(NA, "NA"), "Other", journal)) %>% 
  mutate(journal = toupper(journal)) %>% 
  group_by(journal) %>% 
  summarise(n = n()) 

ggplot2::ggplot(jrnlTemp) +
  geom_bar(aes(x = journal, y =n), stat = 'identity') +
  ylab('number of articles') + xlab("") +
  coord_flip()+
  theme_bw() + 
  theme(axis.text.y = element_text( hjust = 1, size = 8))
```

```{r jrnlYearFig,  fig.cap= "Number of methods publisheed over time."}
yearTemp <- finalMetricsList %>% 
  group_by(year) %>% 
  summarise(n = n()) 

ggplot(yearTemp ) +
  geom_bar(aes(x = year, y =n), stat = 'identity') +
  ylab("articles published ") + xlab('publication year') +
  theme_bw() + theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 12))

```
## Discussion 

In this chapter I highlighted the plethora of regime detection metrics (RDMs) proposed in the literature for analyzing ecological data. Although multiple reviews of RDMs exist, they are not comprehensive in their survey of the possible methods. Most reviews have summarized various aspects of RDMs. For example,  @roberts2018early summarizes methods capable of handling multiple (c.f. a single) variable, and @dakos2015resilience review only methods designed to detect the phenomenon of critical slowing down. Here, I did not discriminate, but rather highlight, the diversity of methods proposed to ecological detect regime shifts, *sensu lato*. This chapter provides a much-needed update to collection provided by @rodionov_brief_2005. 

```{r methodsMetricsListTab}
long_dt <- metricsList.table[1:10,] %>%
  mutate(label2 = paste0("@",label)) %>%
  dplyr::select(method, type1,label2 )
require(kableExtra)

kable(long_dt, "latex", longtable = T, booktabs = T,   caption = "Longtable") %>%
# add_header_above(c(" ", "Group 1" = 5, "Group 2" = 6)) %>%
  kable_styling(latex_options = c("repeat_header"))
```

A survey of applications of these methods to empirical data may prove useful in highlighting the needs of future research and methodological improvements. Many of the methods presented in Table \@ref(methodsMetricsListTab) have either not been applied to empirical data at all, or were tested only once (in the article introducing the method). Although the more mainstream early-warning indicators (e.g., variance, autoregressive model coefficients) and other mainstream methods have been applied to numerous datasets, they have not been rigorously tested on noisy, high dimensional, empirical data. Further, the methods which are not mainstream but have been applied to one of these data types have not any statistical indicators associated with confirming the existence and location of the regime shift. 

As shown this chapter, identifying RDMs using traditional literature review techniques may prove difficult. Many of the methods identified in my review were not identified using Web of Science or Google Scholar--rather, I was either previously aware of most of the methods, and many others were highlighted in previous RDM reviews [@scheffer2015generic, @rodionov_brief_2005, @andersen_ecological_2009,  @roberts2018early, @dakos2015resilience, @nichols_detection_2011]. To facilitate this process, an online, comprehensive database may prove useful to the practical ecologist. 

### Next steps
Change-point detection is a huge field, especially in information and control theory [@aminikhanghahi2017survey]. I purposefully did not survey this, the climatological, and the econometric literatures, which are replete with additional change-point analyses. I suspect most of the methods in Table \@ref(methodsMetricsListTab) were used to analyze climate and economy time series prior to application to ecological data. A database or online resource comprising a comprehensive survey of these and other methods in the relevant literatures may prove useful to the practical ecologist. Further, disemminating various criteria and characteristics relevant  ecological data analysis by way of interactive toosl, e.g. issue trees, may better the utility of this database and the methods themselves. I pose a series of questions that may prove useful to the practical ecologist should a database like this be created in Table \@ref(nextStepsTab).

```{r nextStepsTab}
Questions.stat <- c(
  "What are the major assumptions about the distribution?",
  "Does the method explicitly assume stationarity? If not, can it handle non-stationary processes?", 
  "Does the performance of the method change with non-stationarity?",
  "Can the method handle unstructured data (information)?",
  "Does the regime shift need to be identified *a priori*?",
  "Can the method handle multiple regime shifts?",
  "Does the performance of the method change with non-stationarity?",
  "What types of regime shifts can the method detect (e.g., stochastic resonance, slow-fast cycles, noise-induced transition)?",
  "Is it a model- or metric-based method?", 
  "Does it have forecasting potential?",
  "Can the method handle uneven sampling?",
  "What are the minimum data requirements (resolution, extent, number of observations)?",
  "How does the method handle missing data (e.g., new invasions)?", 
  "Does the method assume Eulerian or Lagrangian processes?")

Questions.ecol <- c(
  "Has the method been tested on empirical data? If so, to what rigor?",
  "What is the impact of losing state variables on long-term predictions (e.g., species extinction)?",
  "Can the method identify drivers?",
  "What assumptions does the method make about the system?", 
  "What types of regime shifts are possible in the system?", 
  "Are regime shift(s) suspected *a priori*?",
  "What lag(s) exist in the data (system)?",
  "Would a positive forecast change management action?",
  "Do predictions translate to other systems?",
  "Can we interpolate data if necessary? If so, what does this mean for inference?",
  "In which discipline(s) beyond ecology has the method been tested?"
  )

Questions = tibble(Type = c("Methodological", rep("", length(Questions.stat)-1),"Ecological"  , rep("", length(Questions.ecol)-1)), 
                       Questions = c(Questions.stat, Questions.ecol))

kable(Questions, "latex", longtable = T, booktabs = T,   caption = "Potential questions for a comprehensive review of the **ecological** regime detection metrics literature.") %>%
 kable_styling(full_width = F) %>%
 column_spec(1, bold = T, border_right = T) %>%
  # CANNOT figure out how to use COLLAPSE AND column_spec width at the same time........
 # collapse_rows(columns = 1, valign = "middle", latex_hline = "major") %>%
 column_spec(2, bold = F, width = "30em")
```

