---
title: "Regime Shift Detection"
subtitle: "in noisy, high-dimensional systems " #"<br/> "
author: "Jessica Burnett"
institute: "University of Nebraska-Lincoln"
date: "2019.04.05"#(updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    css: ["default", "myTheme.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
```{r setup, message=FALSE, warning=FALSE, cache=TRUE, echo=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(include = FALSE, warning=FALSE, message=FALSE, cache=TRUE)
pkgs <- c("tidyverse", "here", "xaringan", "knitr")
# create a function to load packages
loadPkgs <- function(packages) {
  for(package_name in packages)
  {library(package_name,character.only=TRUE, quietly = TRUE);}
}
loadPkgs(pkgs)

# Plotting shit
theme_set(theme_bw())
```
```{r sourceFunctions, echo=FALSE}
# Source some functions
myPlot <- function(lab = "driver", x = t,  y1 =S, y2 = D, size =1, hline = D, ann.pos.x = NULL, ann.pos.y = NULL){
  
  ggplot()+
    geom_line(aes(x,S), size = size, color = "black", linetype = 1)+
    geom_hline(yintercept = D, size = size, color = "blue", linetype = 1)+
    annotate("text", x = ann.pos.x, y = ann.pos.y, label = lab)+
    xlab("driver")+
    ylab("ecosystem state")
}
```

<!-- ############ PART I: BACKGROUND ############-->
# Ecosystems are Complex <!-- reef pic -->
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("https://www.australiangeographic.com.au/wp-content/uploads/2018/06/great-barrier-reef-hardy.jpg")
```
Great Barrier Reef (Australia)  
Image credit: [Australia Geographic](https://www.australiangeographic.com.au)

---

# Ecosystems are Complex <!-- list of characteristics -->  
##*(and complicated)*

### - high dimensional    

--
### - many ( $\infty$ ) interactions  

--
### - non-linear  

--
### - non-ergodic (open)   

--
### - difficult to model mathematically     

???
Ecosystems are complex; that is, they are non-ergodic,  high-dimensional and usually non-linear. Understandably, modeling ecosystems with accuracy and utility is difficult. Anyone studying empirical dynamical systems probably understands that as we move beyond a handful of state variables, the likelihood that building a **useful** mathemtaical model of ecosystem dynamics is  impossible for most systems
---

# The Holy Grail of Ecology <!-- 1 -turtle reef pic-->

```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("https://coolkeywest-1165.kxcdn.com/wp-content/uploads/2014/05/reef.jpg")
```
Image credit: [coolkeywest.com](https://coolkeywest-1165.kxcdn.com/wp-content/uploads/2014/05/reef.jpg)

???
- Despite the complexity of ecological systems, ecologists strive to make predictions about these complex systems. 
- One important area of research is predicting changes in ecossystems which push a system from one state into another 
- Especially when the consequences are grave

---

# The Holy Grail of Ecology <!-- ...is prediction -->
<br>  
<br>
<br>
## forecasting change in time to prevent or mitigate undesirable consequences

---

# The Holy Grail of Ecology <!-- 2 - dying reef pic-->
### Predicting undesirable change   
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("https://static1.squarespace.com/static/5a5906400abd0406785519dd/t/5b7b180a6d2a7356c60f4ec4/1534793794260/IYORBank_BeforeAndAfter_TheOceanAgency_07.jpg")
```

Image credit: [The Ocean Agency](https://static1.squarespace.com/static/5a5906400abd0406785519dd/t/5b7b180a6d2a7356c60f4ec4/1534793794260/IYORBank_BeforeAndAfter_TheOceanAgency_07.jpg)

???

Predicting systemic change is especially important when humans are negatively affected.

For example,  the bleaching and eventual death of this coral reef system impacts not only the wildlife within the reef system, but also has downstream impacts on human communities 
 - ecotourism (economy)
 - fisheries (food and economy)
 - nearshore barrier from extreme weather events (safety)

---

# Ecological Regime Shift <!--intro --> 
## what?  a persistent change in the structure or functioning of a system    
</br>  
## how? loss of negative feedback(s) maintaining the system
<br>
## goal? predict in time to prevent

???
- The reef is only one example of what many ecologists are calling, "regime shifts"
- Briefly, an ecological regime shift is a persistent change in the sturcture or functioning of a system
- Regime shifts occur, via a number of pathways, when a system loses the negative feedback(s) maintaining the system in its current state
- Again, the ultimate goal here would be to predict these events, which can negatively imopact humans, in time to either prevent or plan for the negative consequences of such a change.

---

# Ecological Regime Shift <!-- definition -->  
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("https://static1.squarespace.com/static/5a5906400abd0406785519dd/t/5b7b180a6d2a7356c60f4ec4/1534793794260/IYORBank_BeforeAndAfter_TheOceanAgency_07.jpg")
```
Image credit: [The Ocean Agency](https://static1.squarespace.com/static/5a5906400abd0406785519dd/t/5b7b180a6d2a7356c60f4ec4/1534793794260/IYORBank_BeforeAndAfter_TheOceanAgency_07.jpg)

???

---


<!-- ############ PART II: METHOD REVIEW ############-->


# Regime Detection Metrics  <!-- revist complex system characteristics -->  
### - high dimensional    

### - many ( $\infty$ ) interactions  

### - non-linear   

### - non-ergodic (open)    

### - **difficult to model mathematically**  

???

So, revisiting the characteristics of ecosystems, it should be unsurpisingly that descriving ecosystems sufficeintly to make predictions regarding changes is unsurprisingly difficult. 

NUemrous methods have been introduced into our literature descrived as **Early warning indciators** of regime shifts

---

## Regime Detection Metrics <!-- lit review 1-->
### $>70$ methods proposed in ecological literature
### $<10$ are model-free
### $3$ proposed for high-dimensional models  

---

## Regime Detection Metrics <!-- lit review 2 -->
### $>70$ methods proposed in ecological literature
### $<10$ are model-free 
### $3$ proposed for high-dimensional models  
### **None explicitly for noisy data**

---

<!-- ############ PART 3: VELOCITY ############-->

# 2-species toy data

```{r, echo=FALSE, out.width="100%", fig.cap = "Each variable, $x$, is drawn from a normal distribution with means that change at $t = 50$. State variables have constant variance $\\sigma = 5$. "}
knitr::include_graphics(paste0(here::here(), "/figures/exData.png"))
```

---

# Velocity of Ecosystem State, dsdt<!-- velocity -->
### Step 1: first differences

.pull-left[
The first step in calculating $v$ is to obtain the change in values for each state variables,$$x_1$$and$$x_2$$between two consecutive time points (e.g., from $t=1$ to $t=2$:

$\Delta x_1 = x_{1_{t=2}} - x_{1_{t=1}}$

$\Delta x_2 = x_{2_{t=2}} - x_{1_{t=1}}$
]

.pull-right[
```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics(paste0(here::here(), "/figures/exData_t1t2.png"))

```
]
---


<!-- ############ PART X: TEMPLATES ############-->
# NEW SLIDE  <!-- -->

```{r, echo=FALSE, out.width="100%"}
knitr::include_graphics("")
```

Image credit: []()

---


